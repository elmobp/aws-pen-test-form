package com.gu.pentest

import com.amazonaws.regions.{Regions, Region}
import org.scalatest.{FreeSpec, Matchers, OptionValues}

class MainTest extends FreeSpec with Matchers with OptionValues {
  "argParser" - {
    "correctly parses a profile argument" in {
      Main.argParser.parse(Seq("test"), Arguments()).value should have ('profile ("test"))
    }

    "fails to parse if the  profile argument is missing" in {
      Main.argParser.parse(Nil, Arguments()) shouldEqual None
    }

    "parses a valid region as the second argument" in {
      Main.argParser.parse(Seq("test", "eu-west-1"), Arguments()).value should have (
        'region (Region.getRegion(Regions.EU_WEST_1))
      )
    }

    "fails if given an invalid AWS region as a second argument" in {
      Main.argParser.parse(Seq("test", "not a valid region"), Arguments()) shouldEqual None
    }
  }
}
